from typing import *
from math import *
from collections import *
import time

ma = int(1e6 + 1)
sieve = list(range(ma + 1))

for i in range(2, ma):
    if i == sieve[i]:
        for j in range(i * i, ma, i):
            sieve[j] = min(sieve[j], i)


class Solution:
    def findValidSplit(self, nums: List[int]) -> int:
        def getPrimeFactor(x: int) -> list:
            res = []
            while x != 1:
                res.append(sieve[x])
                div = sieve[x]
                while x % div == 0 and x != 1:
                    x //= div
            return res

        last_pos = [0] * ma
        for i, v in enumerate(nums):
            pf = getPrimeFactor(v)
            for f in pf:
                last_pos[f] = i

        res = 0
        for i, v in enumerate(nums):
            if i < len(nums) - 1:
                pf = getPrimeFactor(v)
                for f in pf:
                    res = max(res, last_pos[f])
                if res == i:
                    return i
        return -1


begin = time.time_ns()
s = Solution()
print(
    s.findValidSplit(
        [
            228587,
            670099,
            156419,
            128327,
            816587,
            491213,
            719893,
            761897,
            939707,
            431513,
            950347,
            30539,
            40823,
            135469,
            481417,
            350443,
            929581,
            793757,
            865001,
            606743,
            468709,
            736441,
            640483,
            662797,
            497711,
            37799,
            660941,
            947857,
            912103,
            228587,
            780809,
            119549,
            761897,
            565727,
            414643,
            352123,
            786127,
            261059,
            575177,
            981983,
            584183,
            434963,
            348731,
            864121,
            592987,
            377123,
            376811,
            511109,
            308117,
            980887,
            981817,
            918899,
            235369,
            15329,
            310747,
            91283,
            319639,
            998167,
            81463,
            644431,
            376463,
            349409,
            101419,
            905581,
            829121,
            98453,
            955879,
            269579,
            659513,
            273061,
            508531,
            491213,
            539897,
            890467,
            427879,
            379207,
            948391,
            647951,
            97847,
            516371,
            796867,
            963689,
            461297,
            424537,
            433507,
            210209,
            894059,
            881669,
            878789,
            269513,
            827693,
            293,
            340957,
            556093,
            879617,
            179167,
            295943,
            930187,
            975553,
            75511,
            833197,
            524231,
            911231,
            441073,
            40699,
            209477,
            113437,
            687901,
            399989,
            213223,
            605533,
            734087,
            466561,
            113027,
            306263,
            119983,
            274237,
            373063,
            51001,
            396971,
            512581,
            268861,
            343891,
            549167,
            383797,
            238789,
            44953,
            950227,
            942869,
            369407,
            179989,
            435439,
            373567,
            669023,
            286771,
            666557,
            239957,
            116101,
            17957,
            842473,
            645577,
            12899,
            494191,
            181903,
            721169,
            713149,
            46279,
            327829,
            847109,
            280963,
            242617,
            423323,
            510619,
            428663,
            553253,
            701221,
            641519,
            773081,
            834469,
            347051,
            772757,
            243137,
            510619,
            66239,
            696313,
            294479,
            646181,
            218839,
            702379,
            834469,
            191579,
            40289,
            312209,
            429917,
            609743,
            493607,
            902753,
            501001,
            289759,
            677021,
            676891,
            71987,
            297421,
            373007,
            988763,
            385661,
            777041,
            169063,
            161459,
            757063,
            36677,
            839981,
            580913,
            767089,
            751759,
            104677,
            628373,
            529381,
            486583,
            952117,
            344263,
            462571,
            324529,
            779267,
            787519,
            176779,
            623699,
            873133,
            297049,
            346223,
            458323,
            660409,
            151523,
            212039,
            628373,
            726853,
            350033,
            125029,
            555761,
            962911,
            785809,
            157897,
            831433,
            576293,
            455701,
            255973,
            668959,
            605837,
            167771,
            250499,
            24203,
            6719,
            384473,
            781741,
            479231,
            414259,
            457397,
            706829,
            19373,
            94399,
            221909,
            566453,
            839303,
            401861,
            234211,
            45413,
            894301,
            140123,
            888557,
            425791,
            797743,
            633649,
            476831,
            479813,
            474073,
            249257,
            185681,
            209813,
            899681,
            839303,
            633649,
            481847,
            67391,
            3049,
            578399,
            376393,
            201511,
            148063,
            879973,
            521537,
            820969,
            257953,
            68699,
            47459,
            991079,
            763481,
            929497,
            309481,
            425233,
            8059,
            771049,
            127579,
            445589,
            317267,
            275591,
            131947,
            622187,
            818309,
            917951,
        ]
    )
)
print(time.time_ns() - begin / 1e9)
